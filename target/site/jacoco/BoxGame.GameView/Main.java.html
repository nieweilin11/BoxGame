<?xml version="1.0" encoding="UTF-8"?><!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd"><html xmlns="http://www.w3.org/1999/xhtml" lang="en"><head><meta http-equiv="Content-Type" content="text/html;charset=UTF-8"/><link rel="stylesheet" href="../jacoco-resources/report.css" type="text/css"/><link rel="shortcut icon" href="../jacoco-resources/report.gif" type="image/gif"/><title>Main.java</title><link rel="stylesheet" href="../jacoco-resources/prettify.css" type="text/css"/><script type="text/javascript" src="../jacoco-resources/prettify.js"></script></head><body onload="window['PR_TAB_WIDTH']=4;prettyPrint()"><div class="breadcrumb" id="breadcrumb"><span class="info"><a href="../jacoco-sessions.html" class="el_session">Sessions</a></span><a href="../index.html" class="el_report">Game</a> &gt; <a href="index.source.html" class="el_package">boxgame.GameView</a> &gt; <span class="el_source">Main.java</span></div><h1>Main.java</h1><pre class="source lang-java linenums">package boxgame.GameView;

import boxgame.Controller.RoundController;
import boxgame.Controller.SaveController;
import boxgame.Model.Player;
import javafx.application.Application;
import javafx.geometry.Pos;
import javafx.scene.Scene;
import javafx.scene.control.Button;
import javafx.scene.control.Label;
import javafx.scene.control.TextField;
import javafx.scene.image.Image;
import javafx.scene.layout.AnchorPane;
import javafx.scene.paint.Color;
import javafx.scene.shape.Circle;
import javafx.scene.shape.Line;
import javafx.scene.shape.Polyline;
import javafx.scene.text.Font;
import javafx.stage.Stage;
import org.tinylog.Logger;

import java.util.ArrayList;
import java.util.List;

import static boxgame.GameView.SetJavaFxObject.*;

/**
 * @author Nie Weilin
 */
<span class="nc" id="L30">public class Main extends Application {</span>

<span class="nc" id="L32">    private final Player player = Player.getPlayer();</span>
<span class="nc" id="L33">    private final SaveController saveController = SaveController.getSaveController();</span>
<span class="nc" id="L34">    private final RoundController roundController = RoundController.getRoundController();</span>
<span class="nc" id="L35">    private final List &lt;Circle&gt;puzzleList = roundController.getPuzzleList();</span>
<span class="nc" id="L36">    private final List &lt;Polyline&gt;boxList = roundController.getBoxsList();</span>

    @Override
    public void start(Stage primaryStage) {

<span class="nc" id="L41">        roundController.init();</span>

<span class="nc" id="L43">        final int line = 11;</span>
<span class="nc" id="L44">        final int empty = 10;</span>
<span class="nc" id="L45">        ArrayList&lt;Line&gt; lList = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L46">        ArrayList&lt;Label&gt; rank = new ArrayList&lt;&gt;();</span>

<span class="nc bnc" id="L48" title="All 2 branches missed.">        for (int i = 0; i &lt; line; i++) {</span>
<span class="nc" id="L49">            lList.add(new Line(0, 46 * i, 200, 46 * i));</span>
        }
<span class="nc" id="L51">        Line line1 = new Line(30, 0, 30, 500);</span>
<span class="nc" id="L52">        Line line2 = new Line(80, 0, 80, 500);</span>
<span class="nc" id="L53">        lList.add(line1);</span>
<span class="nc" id="L54">        lList.add(line2);</span>

<span class="nc bnc" id="L56" title="All 2 branches missed.">        for (var i = 0; i &lt; line; i++) {</span>
<span class="nc" id="L57">            String text = &quot;&quot; + i;</span>
<span class="nc" id="L58">            rank.add(new Label(text));</span>
<span class="nc" id="L59">            setLabelPosition(rank.get(i), 4, 46 * i);</span>
<span class="nc" id="L60">            rank.get(i).setFont(new Font(26));</span>
        }

<span class="nc" id="L63">        Button newGame = new Button(&quot;Start New Game&quot;);</span>
<span class="nc" id="L64">        Button score = new Button(&quot;Rank&quot;);</span>
<span class="nc" id="L65">        Button aboutMe = new Button(&quot;About Me&quot;);</span>
<span class="nc" id="L66">        Button loadGame = new Button(&quot;Load a Game&quot;);</span>
<span class="nc" id="L67">        Button save = new Button(&quot;Save&quot;);</span>
<span class="nc" id="L68">        Button homeGame = new Button(&quot;Home&quot;);</span>
<span class="nc" id="L69">        Button homeLoad = new Button(&quot;Home&quot;);</span>
<span class="nc" id="L70">        Button homeNew = new Button(&quot;Home&quot;);</span>
<span class="nc" id="L71">        Button loadConfirm = new Button(&quot;confirm&quot;);</span>
<span class="nc" id="L72">        Button newConfirm = new Button(&quot;confirm&quot;);</span>
<span class="nc" id="L73">        Button quickWin = new Button(&quot;QuickWin&quot;);</span>
<span class="nc" id="L74">        Label homeTitle = new Label(&quot;boxgame&quot;);</span>
<span class="nc" id="L75">        ArrayList&lt;Label&gt; rankName = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L76">        ArrayList&lt;Label&gt; rankScore = new ArrayList&lt;&gt;();</span>
<span class="nc" id="L77">        TextField saveFile = new TextField();</span>
<span class="nc" id="L78">        TextField name = new TextField();</span>

<span class="nc bnc" id="L80" title="All 2 branches missed.">        for (int i = 0; i &lt; empty; i++) {</span>
<span class="nc" id="L81">           rankName.add(new Label(&quot; &quot;));</span>
<span class="nc" id="L82">            setLabelSize(rankName.get(i),50,60);</span>
<span class="nc" id="L83">            setLabelPosition(rankName.get(i),82,10 + i * 46);</span>
        }
<span class="nc bnc" id="L85" title="All 2 branches missed.">        for (int i = 0; i &lt; empty; i++) {</span>
<span class="nc" id="L86">            rankScore.add(new Label(&quot;0.0&quot;));</span>
<span class="nc" id="L87">            setLabelSize(rankScore.get(i),50,60);</span>
<span class="nc" id="L88">            setLabelPosition(rankScore.get(i),40,10 + i * 46);</span>
        }

<span class="nc" id="L91">        homeTitle.setTextFill(Color.rgb(0, 0, 0));</span>
<span class="nc" id="L92">        homeTitle.setFont(new Font(50));</span>
<span class="nc" id="L93">        setButtonPosition(quickWin,915, 420);</span>
<span class="nc" id="L94">        setButtonPosition(save, 880, 450);</span>
<span class="nc" id="L95">        setButtonPosition(aboutMe, 200, 450);</span>
<span class="nc" id="L96">        setButtonPosition(homeLoad, 400, 450);</span>
<span class="nc" id="L97">        setButtonPosition(homeNew, 400, 450);</span>
<span class="nc" id="L98">        setButtonPosition(loadGame, 400, 450);</span>
<span class="nc" id="L99">        setButtonPosition(score, 935, 420);</span>
<span class="nc" id="L100">        setTextFile(saveFile, 150, 200);</span>
<span class="nc" id="L101">        setTextFile(name, 150, 200);</span>
<span class="nc" id="L102">        setButtonPosition(loadConfirm, 250, 220);</span>
<span class="nc" id="L103">        setButtonPosition(newConfirm, 250, 220);</span>
<span class="nc" id="L104">        setButtonPosition(newGame, 300, 300);</span>
<span class="nc" id="L105">        setButtonPosition(loadGame, 100, 300);</span>
<span class="nc" id="L106">        setButtonPosition(homeGame, 930, 450);</span>
<span class="nc" id="L107">        setLabelPosition(homeTitle, 30, 195);</span>
<span class="nc" id="L108">        setLabelSize(homeTitle, 80, 400);</span>
<span class="nc" id="L109">        homeTitle.setAlignment(Pos.CENTER);</span>

<span class="nc" id="L111">        AnchorPane homePane = new AnchorPane();</span>
<span class="nc" id="L112">        AnchorPane gamePane = new AnchorPane();</span>
<span class="nc" id="L113">        AnchorPane loadPane = new AnchorPane();</span>
<span class="nc" id="L114">        AnchorPane newGamePane = new AnchorPane();</span>
<span class="nc" id="L115">        AnchorPane scorePane = new AnchorPane();</span>

<span class="nc" id="L117">        homePane.setStyle(&quot;-fx-background-image: url(&quot; + &quot;file:src/main/resources/Image/red.jpg&quot; + &quot;); &quot;</span>
                +
                &quot;-fx-background-position: center center; &quot;
                +
                &quot;-fx-background-repeat: stretch;&quot;
                +
                &quot;-fx-background-color:  transparent;&quot;);
<span class="nc" id="L124">        gamePane.setStyle(&quot;-fx-background-image: url(&quot;</span>
                +
                &quot;file:src/main/resources/Image/game.jpg&quot; + &quot;); &quot;
                +
                &quot;-fx-background-position: center center; &quot;
                +
                &quot;-fx-background-repeat: stretch;&quot;
                +
                &quot;-fx-background-color:  transparent;&quot;);
<span class="nc" id="L133">        loadPane.setStyle(&quot;-fx-background-image: url(&quot;</span>
                +
                &quot;file:src/main/resources/Image/black.jpg&quot;
                +
                &quot;); &quot;
                +
                &quot;-fx-background-position: center center; &quot;
                +
                &quot;-fx-background-repeat: stretch;&quot;
                +
                &quot;-fx-background-color:  transparent;&quot;);
<span class="nc" id="L144">        newGamePane.setStyle(&quot;-fx-background-image: url(&quot;</span>
                + &quot;file:src/main/resources/Image/black.jpg&quot;
                +
                &quot;); &quot;
                +
                &quot;-fx-background-position: center center; &quot;
                +
                &quot;-fx-background-repeat: stretch;&quot;
                +
                &quot;-fx-background-color:  transparent;&quot;);

<span class="nc" id="L155">        Scene primaryScene = new Scene(homePane, 500, 500);</span>
<span class="nc" id="L156">        Scene gameScene = new Scene(gamePane, 1000, 500);</span>
<span class="nc" id="L157">        Scene loadScene = new Scene(loadPane, 500, 500);</span>
<span class="nc" id="L158">        Scene newGameScene = new Scene(newGamePane, 500, 500);</span>
<span class="nc" id="L159">        Scene scoreScene = new Scene(scorePane, 200, 500);</span>

<span class="nc" id="L161">        name.setPromptText(&quot;      Enter your name&quot;);</span>
<span class="nc" id="L162">        saveFile.setPromptText(&quot;      Enter your name&quot;);</span>

<span class="nc" id="L164">        selectEvent();</span>

<span class="nc" id="L166">        quickWin.setOnAction(actionEvent -&gt; {</span>
<span class="nc" id="L167">            ArrayList&lt;Integer&gt; arrayList = new ArrayList&lt;&gt;();</span>
<span class="nc bnc" id="L168" title="All 2 branches missed.">            for (int i = 0; i &lt; roundController.totalBox; i++) {</span>
<span class="nc" id="L169">                arrayList.add(0);</span>
<span class="nc bnc" id="L170" title="All 2 branches missed.">                if (i &lt; 4) {</span>
<span class="nc" id="L171">                    arrayList.set(i,1);</span>
                }
<span class="nc bnc" id="L173" title="All 4 branches missed.">                if (i &gt; 3 &amp;&amp; i &lt; 7){</span>
<span class="nc" id="L174">                    arrayList.set(i,2);</span>
                }
<span class="nc" id="L176">                roundController.judgePlayerMovement();</span>
            }
<span class="nc" id="L178">            player.setPlayerStep(arrayList);</span>
<span class="nc" id="L179">        });</span>

<span class="nc" id="L181">        newConfirm.setOnAction(actionEvent -&gt; {</span>
<span class="nc bnc" id="L182" title="All 2 branches missed.">            if (name.getText() == null) {</span>
<span class="nc" id="L183">                name.setText(&quot;player&quot;);</span>
            }
<span class="nc" id="L185">            player.setPlayerName(name.getText());</span>
<span class="nc" id="L186">            System.out.println(&quot;name:&quot; + player.getPlayerName());</span>
<span class="nc" id="L187">            roundController.startTime();</span>
<span class="nc" id="L188">            roundController.displayStones();</span>
<span class="nc" id="L189">            primaryStage.setScene(gameScene);</span>
<span class="nc" id="L190">        });</span>

<span class="nc" id="L192">        homeGame.setOnAction(actionEvent -&gt; {</span>
<span class="nc" id="L193">            primaryStage.setScene(primaryScene);</span>
<span class="nc" id="L194">            saveController.write();</span>
<span class="nc" id="L195">        });</span>

<span class="nc" id="L197">        loadConfirm.setOnAction(actionEvent -&gt; {</span>
<span class="nc" id="L198">            player.setPlayerName(saveFile.getText());</span>
<span class="nc bnc" id="L199" title="All 2 branches missed.">            if (saveFile.getText() == null) {</span>
<span class="nc" id="L200">                saveFile.setText(&quot;player&quot;);</span>
            }
<span class="nc" id="L202">            System.out.println(&quot;name:&quot; + player.getPlayerName());</span>
<span class="nc" id="L203">            primaryStage.setScene(gameScene);</span>
<span class="nc" id="L204">            roundController.startTime();</span>
<span class="nc" id="L205">            saveController.read();</span>
<span class="nc" id="L206">            roundController.displayStones();</span>
<span class="nc" id="L207">        });</span>
<span class="nc" id="L208">        score.setOnAction(actionEvent -&gt; {</span>
<span class="nc" id="L209">            saveController.rank();</span>
<span class="nc" id="L210">            saveController.validPlayer();</span>
<span class="nc bnc" id="L211" title="All 4 branches missed.">            for (int i = 0;i &lt; saveController.getValidPlayer().size() &amp;&amp; i&lt;empty ;i++)  {</span>
<span class="nc" id="L212">                System.out.println(saveController.getValidPlayer().get(i));</span>
<span class="nc" id="L213">                rankName.get(i).setText(saveController.getValidPlayer().get(i).getString(&quot;Name&quot;));</span>
<span class="nc" id="L214">                rankScore.get(i).setText(saveController.getValidPlayer().get(i).getString(&quot;Score&quot;));</span>
            }
<span class="nc" id="L216">            Stage scoreStage = new Stage();</span>
<span class="nc" id="L217">            scoreStage.setHeight(500);</span>
<span class="nc" id="L218">            scoreStage.setWidth(200);</span>
<span class="nc" id="L219">            scoreStage.setScene(scoreScene);</span>
<span class="nc" id="L220">            scoreStage.show();</span>
<span class="nc" id="L221">        });</span>
<span class="nc" id="L222">        save.setOnAction(actionEvent -&gt; {</span>
<span class="nc" id="L223">            roundController.endTime();</span>
<span class="nc" id="L224">            player.setScore(roundController.score() + player.getScore());</span>
<span class="nc" id="L225">            saveController.write();</span>
<span class="nc" id="L226">            Logger.trace(&quot;Score &quot; + player.getScore());</span>
<span class="nc" id="L227">            Logger.trace(&quot;Saved!&quot;);</span>
<span class="nc" id="L228">        });</span>


<span class="nc" id="L231">        newGame.setOnAction(actionEvent -&gt; primaryStage.setScene(newGameScene));</span>
<span class="nc" id="L232">        homeNew.setOnAction(actionEvent -&gt; primaryStage.setScene(primaryScene));</span>
<span class="nc" id="L233">        loadGame.setOnAction(actionEvent -&gt; primaryStage.setScene(loadScene));</span>
<span class="nc" id="L234">        homeLoad.setOnAction(actionEvent -&gt; primaryStage.setScene(primaryScene));</span>

<span class="nc" id="L236">        homePane.getChildren().addAll(newGame, loadGame, homeTitle, aboutMe);</span>
<span class="nc" id="L237">        loadPane.getChildren().addAll(homeLoad, loadConfirm, saveFile);</span>
<span class="nc" id="L238">        newGamePane.getChildren().addAll(newConfirm, homeNew, name);</span>
<span class="nc" id="L239">        gamePane.getChildren().addAll(save, homeGame,score);</span>

<span class="nc bnc" id="L241" title="All 2 branches missed.">            for (var i = 1; i &lt; boxList.size(); i++) {</span>
<span class="nc" id="L242">                gamePane.getChildren().add(boxList.get(i));</span>
            }
<span class="nc bnc" id="L244" title="All 2 branches missed.">            for (Line value : lList) {</span>
<span class="nc" id="L245">                scorePane.getChildren().addAll(value);</span>
<span class="nc" id="L246">            }</span>
<span class="nc bnc" id="L247" title="All 2 branches missed.">            for (Label label : rank) {</span>
<span class="nc" id="L248">                scorePane.getChildren().add(label);</span>
<span class="nc" id="L249">            }</span>
<span class="nc bnc" id="L250" title="All 2 branches missed.">            for (Label label:rankName){</span>
<span class="nc" id="L251">                scorePane.getChildren().add(label);</span>
<span class="nc" id="L252">            }</span>
<span class="nc bnc" id="L253" title="All 2 branches missed.">            for (Label label:rankScore) {</span>
<span class="nc" id="L254">                scorePane.getChildren().add(label);</span>
<span class="nc" id="L255">            }</span>
<span class="nc bnc" id="L256" title="All 2 branches missed.">            for (Circle circle : puzzleList) {</span>
<span class="nc" id="L257">                gamePane.getChildren().add(circle);</span>
<span class="nc" id="L258">            }</span>

          //add panes into stage and set stage

<span class="nc" id="L262">            primaryStage.setScene(primaryScene);</span>
<span class="nc" id="L263">            primaryStage.setTitle(&quot;boxgame&quot;);</span>
<span class="nc" id="L264">            primaryStage.centerOnScreen();</span>
<span class="nc" id="L265">            primaryStage.setY(primaryStage.getY() * 3f / 2f);</span>
<span class="nc" id="L266">            primaryStage.setResizable(false);</span>
<span class="nc" id="L267">            primaryStage.getIcons().add(new Image(&quot;C:\\Users\\Fish\\IdeaProjects\\Game\\src\\main\\resources\\Image\\29x29.jpg&quot;));</span>
<span class="nc" id="L268">            primaryStage.show();</span>
<span class="nc" id="L269">            primaryStage.setOnCloseRequest(event -&gt; saveController.write());</span>
<span class="nc" id="L270">    }</span>

    public static void main(String[] args) {
<span class="nc" id="L273">        launch();</span>
<span class="nc" id="L274">    }</span>

}
</pre><div class="footer"><span class="right">Created with <a href="http://www.jacoco.org/jacoco">JaCoCo</a> 0.8.8.202204050719</span></div></body></html>